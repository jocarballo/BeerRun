<div id="head">
  <nav class="nav-bar">
    <form action="/home" method="POST" >
        <button class="btn btn-danger">Logout</button>
    </form>
  </nav>

<p>Hello {{user.username}}</p>

     <form action="/trip/create" method="post">
      <div class="row mb-3" style="width: 18rem;">
        <label> Name
          <input type="text" name="name" placeholder="BeerRunner" />
        </label>
        <p>Start Location</p>
        <div id="startGeocoder"></div>
        <p>End Location</p>
        <div id="endGeocoder"></div>
        <input type="hidden" name="startLatitudePoint" value=""/>
        <input type="hidden" name="startLongitudePoint" value=""/>
        <input type="hidden" name="endLatitudePoint" value=""/>
        <input type="hidden" name="endLongitudePoint" value=""/>
        <button type="submit" class="btn btn-success">Create Trip</button>
      </div>
     </form>
</div>
</div>
    {{!-- error message will be added here --}}
  </form>
</div>

<h1>{{user.username}}</h1>

<p>All Beer Runs</p>
{{#each beerRuns}}
  <div class="card" style="width: 18rem;">
    <img src="..." class="card-img-top" alt="..." />
    <div class="card-body">
      <h5 class="card-title">{{this.name}}</h5>
      <p class="card-text">Some quick example text to build on the card title
        and make up the bulk of the card's content.</p>
      <a href="/trip/{{this._id}}" class="btn btn-primary">View trip</a>
    </div>
  </div>
{{/each}}

<p>Your Beer Runs</p>
{{#each userBeerRuns}}
  <div class="card" style="width: 18rem;">
    <img src="..." class="card-img-top" alt="..." />
    <div class="card-body">
      <h5 class="card-title">{{this.name}}</h5>
      <p class="card-text">Some quick example text to build on the card title
        and make up the bulk of the card's content.</p>
      <a href="/trip/{{this._id}}" class="btn btn-primary">View trip</a>
    </div>
  </div>
{{/each}}


<script>
mapboxgl.accessToken = 'pk.eyJ1Ijoiam9jYXJiYWxsbyIsImEiOiJja3puMzVsaWM0YTl2MzBvMWVqcHJxaWhiIn0.UJWUB-BwaxMmZH4w7eSgGQ';

const startGeocoder = new MapboxGeocoder({
  accessToken: mapboxgl.accessToken,
  types: 'address'
});

startGeocoder.addTo('#startGeocoder');
startGeocoder.on('result', (e) => {
    let latitude = e.result.geometry.coordinates[1];
    let longitude = e.result.geometry.coordinates[0];

    let startLatitudeElem = document.querySelector('[name="startLatitudePoint"]');
    let startLongitudeElem = document.querySelector('[name="startLongitudePoint"]');

    startLatitudeElem.setAttribute('value', latitude);
    startLongitudeElem.setAttribute('value', longitude);
});

// Clear results container when search is cleared.
startGeocoder.on('clear', () => {

});

const endGeocoder = new MapboxGeocoder({
  accessToken: mapboxgl.accessToken,
  types: 'address'
});

endGeocoder.addTo('#endGeocoder');
endGeocoder.on('result', (e) => {
    let latitude = e.result.geometry.coordinates[1];
    let longitude = e.result.geometry.coordinates[0];

    let endLatitudeElem = document.querySelector('[name="endLatitudePoint"]');
    let endLongitudeElem = document.querySelector('[name="endLongitudePoint"]');

    endLatitudeElem.setAttribute('value', latitude);
    endLongitudeElem.setAttribute('value', longitude);
});

// Clear results container when search is cleared.
endGeocoder.on('clear', () => {

});
</script>
